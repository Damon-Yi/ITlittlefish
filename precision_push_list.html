<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>精准推送</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <link href="css/public.css" rel="stylesheet" type="text/css">
    <link href="css/precision_push.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="plugin/dropload/dropload.css">
    <script src="js/public.js"></script>
    <style type="text/css">
        body{background-color: #e9e9e9;}
    </style>
</head>
<body>
    <div class="page_header">
        <p>精准推送</p>
        <div class="right_add"><i class="position"></i><span>深圳</span></div>
    </div>
    <div class="h_push_tips">根据您提交的信息，精准推送以下产品</div>
    <div class="h_push">
        <div class="h_push_list">
            <!-- <div class="h_push_item">
                <div class="h_push_row_1">
                    <div class="h_push_col_1">
                        <div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div>
                        <div class="h_push_img_logo"><img src="../images/precision_loan_03.png"></div>
                    </div>
                    <div class="h_push_col_2">
                        <p class="h_push_p_1">平安i贷-应急贷</p>
                        <p class="h_push_p_2">适用人群：所有人群</p>
                        <p class="h_push_p_3">申请人数：1135248人</p>
                    </div>
                    <div class="h_push_col_3">
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">成功率</p>
                                <p class="color_red">45.00%</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">日利率</p>
                                <p class="color_red">1%</p>
                            </div>
                        </div>
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">平均额度</p>
                                <p class="color_red">0.50万</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">平均用时</p>
                                <p class="color_red">当天放款</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="h_push_row_2">
                    <p>最高额度：<span class="h_max_num">3万</span></p>
                </div>
                <div class="h_push_row_3">
                    <span class="active">身份证</span><span>网购账号</span><span>支付宝账号</span><span>信用卡</span><span>手机认证</span>
                </div>
            </div>
            <div class="h_push_item">
                <div class="h_push_row_1">
                    <div class="h_push_col_1">
                        <div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div>
                        <div class="h_push_img_logo"><img src="../images/precision_loan_04.png"></div>
                    </div>
                    <div class="h_push_col_2">
                        <p class="h_push_p_1">曹操贷-极速贷款</p>
                        <p class="h_push_p_2">适用人群：上班族、个体户、大学生</p>
                        <p class="h_push_p_3">申请人数：337290人</p>
                    </div>
                    <div class="h_push_col_3">
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">成功率</p>
                                <p class="color_red">25.00%</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">日利率</p>
                                <p class="color_red">0.3%</p>
                            </div>
                        </div>
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">平均额度</p>
                                <p class="color_red">0.10万</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">平均用时</p>
                                <p class="color_red">2小时</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="h_push_row_2">
                    <p>最高额度：<span class="h_max_num">0.3万</span></p>
                </div>
                <div class="h_push_row_3">
                    <span class="active">身份证</span><span>网购账号</span><span>支付宝账号</span><span>信用卡</span><span>手机认证</span>
                </div>
            </div>
            <div class="h_push_item">
                <div class="h_push_row_1">
                    <div class="h_push_col_1">
                        <div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div>
                        <div class="h_push_img_logo"><img src="../images/precision_loan_05.png"></div>
                    </div>
                    <div class="h_push_col_2">
                        <p class="h_push_p_1">现金侠-极速贷款</p>
                        <p class="h_push_p_2">适用人群：所有人群</p>
                        <p class="h_push_p_3">申请人数：1135248人</p>
                    </div>
                    <div class="h_push_col_3">
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">成功率</p>
                                <p class="color_red">20.00%</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">日利率</p>
                                <p class="color_red">0.3%</p>
                            </div>
                        </div>
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">平均额度</p>
                                <p class="color_red">0.10万</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">平均用时</p>
                                <p class="color_red">1小时</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="h_push_row_2">
                    <p>最高额度：<span class="h_max_num">3万</span></p>
                </div>
                <div class="h_push_row_3">
                    <span class="active">身份证</span><span>网购账号</span><span>支付宝账号</span><span>信用卡</span><span>手机认证</span>
                </div>
            </div>
            <div class="h_push_item">
                <div class="h_push_row_1">
                    <div class="h_push_col_1">
                        <div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div>
                        <div class="h_push_img_logo"></div>
                    </div>
                    <div class="h_push_col_2">
                        <p class="h_push_p_1">xxxx-产品名字</p>
                        <p class="h_push_p_2">适用人群：xxxx</p>
                        <p class="h_push_p_3">申请人数：xxxxxx人</p>
                    </div>
                    <div class="h_push_col_3">
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">成功率</p>
                                <p class="color_red">xxx%</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">日利率</p>
                                <p class="color_red">xx%</p>
                            </div>
                        </div>
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">平均额度</p>
                                <p class="color_red">xxxx万</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">平均用时</p>
                                <p class="color_red">x小时</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="h_push_row_2">
                    <p>最高额度：<span class="h_max_num">xxxx万</span></p>
                </div>
                <div class="h_push_row_3">
                    <span class="active">身份证</span><span>网购账号</span><span>支付宝账号</span><span>信用卡</span><span>手机认证</span>
                </div>
            </div>
            <div class="h_push_item">
                <div class="h_push_row_1">
                    <div class="h_push_col_1">
                        <div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div>
                        <div class="h_push_img_logo"></div>
                    </div>
                    <div class="h_push_col_2">
                        <p class="h_push_p_1">xxxx-产品名字</p>
                        <p class="h_push_p_2">适用人群：xxxx</p>
                        <p class="h_push_p_3">申请人数：xxxxxx人</p>
                    </div>
                    <div class="h_push_col_3">
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">成功率</p>
                                <p class="color_red">xxx%</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">日利率</p>
                                <p class="color_red">xx%</p>
                            </div>
                        </div>
                        <div class="h_push_tr">
                            <div class="h_push_td">
                                <p class="">平均额度</p>
                                <p class="color_red">xxxx万</p>
                            </div>
                            <div class="h_push_td">
                                <p class="">平均用时</p>
                                <p class="color_red">x小时</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="h_push_row_2">
                    <p>最高额度：<span class="h_max_num">xxxx万</span></p>
                </div>
                <div class="h_push_row_3">
                    <span class="active">身份证</span><span>网购账号</span><span>支付宝账号</span><span>信用卡</span><span>手机认证</span>
                </div>
            </div> -->
        </div>
    </div>
    <script type="text/javascript" src="plugin/zepto/zepto.js"></script>
    <script type="text/javascript" src="plugin/zepto/touch.js"></script>
    <script src="plugin/dropload/dropload.min.js"></script>
    <script>
        var precisionPushQueryData = getLocalStorage('precisionPushQueryData');
        var precisionPushResultData = getLocalStorage('precisionPushResultData');
        //console.log(precisionPushQueryData);
        //console.log(precisionPushResultData);

        if(precisionPushResultData){
            if(precisionPushResultData.rows){
                var hPushList = $('.h_push_list');
                var hPushItems = precisionPushResultData.rows;
                appentData(hPushList,hPushItems);
            }
        }
        $(function(){
            // 页数
            var page = 1;
            // 每页展示10个
            var size = 10;

            // dropload
            $('.h_push').dropload({
                scrollArea : window,
                domUp : {
                    domClass   : 'dropload-up',
                    domRefresh : '<div class="dropload-refresh">↓下拉刷新</div>',
                    domUpdate  : '<div class="dropload-update">↑释放更新</div>',
                    domLoad    : '<div class="dropload-load"><span class="loading"></span>加载中...</div>'
                },
                domDown : {
                    domClass   : 'dropload-down',
                    domRefresh : '<div class="dropload-refresh">↑上拉加载更多</div>',
                    domLoad    : '<div class="dropload-load"><span class="loading"></span>加载中...</div>',
                    domNoData  : '<div class="dropload-noData">暂无数据</div>'
                },
                loadUpFn : function(me){
                    console.log(precisionPushQueryData);
                    var parmas = precisionPushQueryData;
                    $.ajax({
                        type:"post",
                        url:Config.url+"/submitPrecisionPushApply",
                        data:parmas,
                        success: function(data){
                            $('.h_push_list').empty();
                            appentData($('.h_push_list'),rows);
                            setLocalStorage('precisionPushQueryData',parmas);
                        
                            me.resetload();
                            page = 1;
                            // 解锁loadDownFn里锁定的情况
                            me.unlock();
                            me.noData(false);
                        },
                        error: function(xhr, errorType, error){
                            tips(error,'tips_center',1500);
                            // 即使加载出错，也得重置
                            me.resetload();
                        }
                    });
                },
                loadDownFn : function(me){
                    page++;
                    console.log(precisionPushQueryData);
                    var parmas = precisionPushQueryData;
                    parmas.pageNo = page;
                    $.ajax({
                        type:"post",
                        url:Config.url+"/submitPrecisionPushApply",
                        data:parmas,
                        success: function(data){
                            if(data.rows.length>0){
                                appentData($('.h_push_list'),rows);
                                setLocalStorage('precisionPushQueryData',parmas);
                            }else{
                                // 锁定
                                me.lock();
                                // 无数据
                                me.noData(true);
                            }
                            me.resetload();
                        },
                        error: function(xhr, errorType, error){
                            tips(error,'tips_center',1500);
                            // 锁定
                            me.lock();
                            // 无数据
                            me.noData(true);
                            me.resetload();
                        }
                    });
                },
                threshold : 50
            });
        });
        function appentData(obj,rows){
            for(var i=0;i<rows.length;i++){
                var tmpItem = $('<div class="h_push_item"><div class="h_push_row_1"><div class="h_push_col_1"><div class="h_push_img_header"><img src="../images/precision_loan_02.png"></div><div class="h_push_img_logo"><img src="'+rows[i].logourl+'"></div></div><div class="h_push_col_2"><p class="h_push_p_1">'+rows[i].productname+'</p><p class="h_push_p_2">适用人群：'+rows[i].fitpeople+'</p><p class="h_push_p_3">申请人数：'+rows[i].applications+'人</p></div><div class="h_push_col_3"><div class="h_push_tr"><div class="h_push_td"><p class="">成功率</p><p class="color_red">'+rows[i].successrate+'</p></div><div class="h_push_td"><p class="">日利率</p><p class="color_red">'+rows[i].dayrate+'</p></div></div><div class="h_push_tr"><div class="h_push_td"><p class="">平均额度</p><p class="color_red">'+rows[i].averageamount+'</p></div><div class="h_push_td"><p class="">平均用时</p><p class="color_red">'+rows[i].averagetime+'</p></div></div></div></div><div class="h_push_row_2"><p>最高额度：<span class="h_max_num">'+rows[i].ammout+'</span></p></div><div class="h_push_row_3"></div></div>');
                var hPushRow3 = tmpItem.find('.h_push_row_3');
                for(var j=0;j<rows[i].applyingdata.length;j++){
                    var tmpSpan = $('<span class="active">'+rows[i].applyingdata[j]+'</span>');
                    hPushRow3.append(tmpSpan);
                }
                obj.append(tmpItem);
            }
        }
    </script>
</body>
</html>