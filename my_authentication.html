<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <link href="css/public.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="css/my_authentication.css"/>
    <link rel="stylesheet" type="text/css" href="plugin/layer/mobile/need/layer.css"/>
    <script src="plugin/layer/mobile/layer.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/public.js"></script>
    <style>
        .mui-dtpicker-title{display: none;}
        .mui-picker[data-id="picker-y"]{width: 22%;}
        .mui-picker[data-id="picker-y"] .mui-pciker-list li{text-align: right;}
        .mui-picker[data-id="picker-m"]{width: 18%;}
        .mui-picker[data-id="picker-d"]{width: 12%;}
        .mui-picker[data-id="picker-d"] .mui-pciker-list li{text-align: left;}
        .mui-picker[data-id="picker-h"]{width: 48%;}
        .mui-btn-block{padding:0;border:none;font-size: 0.24rem;margin: 0;text-align: left;}
        .netDetailAddr{width:100%;border:none;padding:0.01rem 0}
        .content span i{width: .22rem;height: .22rem;display: inline-block;background: #bfbfbf;border-radius: 1rem;margin-left: .1rem;position: relative;top: 2px;}
   		select{background: transparent;border: none;width: 75%;}
   		.content p{position: relative;}
   		.selectnext{
		   width: 0.18rem !important;
		   height: 0.18rem;
		   display: block;
		   background: transparent;
		   position: absolute;
		   right: 4%;
		   top: 0.15rem;
		   border-left: .18rem solid transparent;
		   border-bottom: .18rem solid black;
		   transform: rotate(45deg);
   		}
    </style>
   <!-- <script type="text/javascript">
        var aScroll;
        function loaded () {
            aScroll = new IScroll('#cont_wrapper',{
                scrollbars: true,
                mouseWheel: true,
                interactiveScrollbars: true,
                shrinkScrollbars: 'scale',
                fadeScrollbars: true,click: true 
            });
        }
       document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    </script>-->
</head>
<body style="background: #ebebeb;">
    <div class="page_header">资料认证</div>
    <div id="cont_wrapper">
        <div style="background: white;">
        	<!--基本资料-->
            <div>
            	<p class="title">基本资料</p>
            	<div class="content">
            		<p>
            			<span>姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名</span>
            			<input type="text" name="username" id="" value="" placeholder="请填写姓名"/>
            		</p>
            		<p>
            			<span>性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别</span>
            			<select class="sex" name="">
            				<option value="">男</option>
            				<option value="">女</option>
            			</select>
            			<span class="selectnext"></span>
            		</p>
            		<p>
            			<span>手机号码</span>
            			<input type="text" style="font-size: .24rem;width: 75%;" class="mobilephone" name="mobilephone" id="" value="" placeholder="请填写手机号码"/>
            		</p>
            		<p>
            			<span>所有城市</span>
            			<span style="text-indent: .1rem;width: 75%" id="schoolCity" class="city_select" data-val="">请选择城市</span>
            		</p>
            		<p class="bordernone">
            			<span>出生年月</span>
        				<span style="text-indent: .1rem;width: 75%" id="schoolTime" class="city_select" data-val="">请选择时间</span>
            		</p>
            	</div>
            </div>
            <!--工作信息-->
            <div>
            	<p class="title">工作信息</p>
            	<div class="content">
            		<p>
            			<span>月&nbsp;&nbsp;收&nbsp;&nbsp;入</span>
            			<span><input style="font-size: .24rem;width: 50%;" type="text" name="monthlyincome" placeholder="请填写月收入"/></span>
            		</p>
            		<p>
            			<span>职业身份</span>
            			<select class="occupational" name="">
            				<option value="">工薪族</option>
            				<option value="">企业主</option>
            				<option value="">在校学生</option>
            				<option value="">网店主</option>
            				<option value="">自由职业者</option>
            			</select>
            			<span class="selectnext"></span>
            		</p>
            		<p>
            			<span>本地社保</span>
            			<span class="choise" style="text-indent: .1rem;">
            				<span class="choisesocial" data-val="1">有<i></i></span>
            				<span class="choisesocial" data-val="0">无<i></i></span>
            			</span>
            		</p>
            		<p class="bordernone">
            			<span>本地公积金</span>
            			<span class="choise" style="text-indent: .1rem;">
            				<span class="choiseaccumulation" data-val="1">有<i></i></span>
            				<span class="choiseaccumulation" data-val="0">无<i></i></span>
            			</span>
            		</p>
            	</div>
            </div>
            
        </div>
        <div class="submit">
        	提交资料认证申请
        </div>
    </div>
    <!--<script type="text/javascript" src="plugin/iscroll/iscroll.js"></script>
    <script type="text/javascript" src="plugin/zepto/zepto.js"></script>
    <script type="text/javascript" src="plugin/zepto/touch.js"></script></body>
    <script type="text/javascript" src="plugin/date/datePicker.js"></script></body>-->
    <script type="text/javascript" src="plugin/zepto/zepto.js"></script>
    <link href="plugin/mui//css/mui.picker.min.css" rel="stylesheet" />
    <link href="plugin/mui//css/mui.poppicker.css" rel="stylesheet" />
    <script src="plugin/mui//js/mui.min.js"></script>
    <script src="plugin/mui/js/mui.picker.min.js"></script>
    <script src="plugin/mui/js/mui.poppicker.js"></script>
    <script src="plugin/mui/js/city.data-3.js" type="text/javascript" charset="utf-8"></script>
    <script>
    	 (function($, doc) {
            $.init();
            $.ready(function() {
                //省市区级联
                var cityPicker3 = new $.PopPicker({
                    layer: 3
                });
                cityPicker3.setData(cityData3);
                //申请的城市
                /*var showCityPicker3 = doc.getElementById('applycity');
                showCityPicker3.addEventListener('tap', function(event) {
                    var _that = this;
                    cityPicker3.show(function(items) {
                        var city = items[0].text+' '+items[1].text+' '+items[2].text;
                        _that.innerHTML = city;
                        _that.setAttribute('data-val',city)
                        console.log(city);
                        //返回 false 可以阻止选择框的关闭
                        //return false;
                    });
                }, false);
                //企业所在地
                var enterpriseLocatedButton = doc.getElementById('enterpriselocated');
                enterpriseLocatedButton.addEventListener('tap', function(event) {
                    var _that = this;
                    cityPicker3.show(function(items) {
                        var city = items[0].text+' '+items[1].text+' '+items[2].text;
                        _that.innerHTML = city;
                        _that.setAttribute('data-val',city)
                        console.log(city);
                        //返回 false 可以阻止选择框的关闭
                        //return false;
                    });
                }, false);
                //学校所在地
                */
                var showCityPickerButton = doc.getElementById('schoolCity');
                showCityPickerButton.addEventListener('tap', function(event) {
                    var _that = this;
                    cityPicker3.show(function(items) {
                        var city = items[0].text+' '+items[1].text+' '+items[2].text;
                        _that.innerHTML = city;
                        _that.setAttribute('data-val',city)
                        console.log(city);
                        //返回 false 可以阻止选择框的关闭
                        //return false;
                    });
                }, false);
                //入学时间
                var showCityPickerButton = doc.getElementById('schoolTime');
                showCityPickerButton.addEventListener('tap', function(event) {
                    var _that = this;
                    var options = {
                        "type":"date",
                        beginDate: new Date(new Date().getFullYear()-10, new Date().getMonth(), new Date().getDate()),//设置开始日期 
                        endDate: new Date(),//设置结束日期 
                        /*"customData":{
                            "h":generateTimeQuantum()//时间段
                        }*/
                    };

                    var picker = new $.DtPicker(options);
                    picker.show(function(rs) {
                        _that.attributes.getNamedItem('data-val').textContent = rs.text;
                        _that.innerText = rs.text;
                        
                        picker.dispose();
                    });
                }, false);
                //有无选择
                var radioSelects = $('.radio_option>span');
                radioSelects.each(function(i, obj) {
                     obj.addEventListener('tap', function() {
                        var spans = this.parentNode.children;
                        for(var i =0;i<spans.length;i++) {
                            if(hasClass(spans[i], 'active')){
                                removeClass(spans[i], 'active');
                            }
                        }
                        addClass(this, 'active');
                     });
                });
            });
        })(mui, document);
        $(function(){
        	
        });
        var xiaoyuuserId;
        if(Cookie.get("userId")){
        	xiaoyuuserId = Cookie.get("userId");
        }
        console.log(Cookie.get("userMessss"))
        $(".sex").val(JSON.parse(Cookie.get("userMessss")).sex);
        $(".mobilephone").val(JSON.parse(Cookie.get("userMessss")).mobilephone)
        var socialsecurity;
        var socialinsurance;
        
        $(".submit").on("tap",function(){
        	console.log()
        	var username = $("input[name = username]")[0].value; //姓名
        	var sex = $(".sex option:checked").text();   	//性别
        	var mobilephone = $("input[name = mobilephone]")[0].value;  //手机号码
        	var city = $("#schoolCity").text(); //所有城市
        	var birthday = $("#schoolTime").text(); // 生日
        	var monthlyincome = $("input[name = monthlyincome]")[0].value; //月收入
        	var profession = $(".occupational option:checked").text(); //职业
        	console.log(socialsecurity);//社保
        	console.log(socialinsurance);//公积金
        	
       	if(!username || !sex || !mobilephone || city == "请选择城市" || birthday == "请选择时间"
        		|| !monthlyincome || !profession || !socialsecurity 
        		|| !socialinsurance){
        			layer.open({
        				content: '请完善资料'
						,skin: 'msg'
						,time: 1.5 //2秒后自动关闭
        			})
        		}
        	$.ajax({
                type:"post",
                url:Config.url+"/dataUpdate",
                data:{
                	'userId':xiaoyuuserId,
	        		"username":username,
	            	"sex":sex,
	            	"mobilephone":mobilephone,
	            	"city":city,
	            	"birthday":birthday,
	            	"monthlyincome":monthlyincome,
	            	"profession":profession,
	            	"socialsecurity":socialsecurity,
	            	"socialinsurance":socialinsurance
                },
                success:function(data, status, xhr){
                	console.log(data)
                    if(data.resultCode==0){
                    	console.log(data)
                        location.href="my_mine.html";
                    }else{
                    	layer.open({
                    		content: data.resultMessage,
							skin: 'msg',
							time: 2 //2秒后自动关闭
                    	})
                    }
                },
                error:function(xhr, errorType, error){
                	console.log(000)
                  	
                },
            });
        })
        
        
        $(".choisesocial").on("tap",function(){
        	console.log($(this).index())
        	$(this).find("i").css("background","#ff9000").siblings();
        	$(this).siblings(".choisesocial").find("i").css("background","#bfbfbf");
        	if($(this).index() == 0){
        		socialsecurity = 1;
        	}else{
        		socialsecurity = 0;
        	}
        })
        
        $(".choiseaccumulation").on("tap",function(){
        	console.log($(this).index())
        	$(this).find("i").css("background","#ff9000").siblings();
        	$(this).siblings(".choiseaccumulation").find("i").css("background","#bfbfbf");
        	if($(this).index() == 0){
        		socialinsurance = 1;
        	}else{
        		socialinsurance = 0;
        	}
        })
        
        
    </script>
</html>